{
    "software": [
        {
            "name": "mysql",
            "description": "MySQL Database Server",
            "install_config": {
                "base_path": "{{.root}}/{{.name}}/v{{.version}}",
                "config_params": [
                    {
                        "name": "port",
                        "type": "number",
                        "default": 3306,
                        "description": "监听端口"
                    },
                    {
                        "name": "root_password",
                        "type": "password",
                        "required": true,
                        "description": "MySQL root密码"
                    },
                    {
                        "name": "buffer_pool_size",
                        "type": "string",
                        "default": "256M",
                        "description": "InnoDB缓冲池大小"
                    }
                ],
                "service_config": {
                    "start_cmd": "{{.bin}}/mysqld --defaults-file={{.conf}}/my.cnf",
                    "stop_cmd": "{{.bin}}/mysqladmin -u root -p{{.params.root_password}} shutdown",
                    "systemd_template": "[Unit]\nDescription=MySQL Service\nAfter=network.target\n\n[Service]\nExecStart={{.start_cmd}}\nRestart=on-failure\n\n[Install]\nWantedBy=multi-user.target"
                }
            },
            "versions": [
                {
                    "version": "8.0.33",
                    "download_url": "https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-8.0.33-linux-glibc2.12-x86_64.tar.gz",
                    "checksum": "sha256:...",
                    "config_templates": {
                        "my.cnf": "port={{.params.port}}\ninnodb_buffer_pool_size={{.params.buffer_pool_size}}"
                    },
                    "params": [
                        {
                            "name": "buffer_pool_size",
                            "type": "string",
                            "default": "256M"
                        }
                    ]
                },
                {
                    "version": "5.7.42",
                    "download_url": "https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.42-linux-glibc2.12-x86_64.tar.gz",
                    "checksum": "sha256:...",
                    "config_templates": {
                        "my.cnf": "[mysqld]\nport={{.params.port}}\nuser=mysql\nsocket=/var/lib/mysql/mysql.sock",
                        "client.cnf": "[client]\nport={{.params.port}}"
                    }
                }
            ]
        },
        {
            "name": "redis",
            "description": "Redis内存数据库",
            "install_config": {
                "base_path": "{{.root}}/{{.name}}/v{{.version}}",
                "config_params": [
                    {
                        "name": "port",
                        "type": "number",
                        "default": 6379,
                        "description": "监听端口"
                    },
                    {
                        "name": "password",
                        "type": "password",
                        "description": "访问密码",
                        "required": true
                    },
                    {
                        "name": "maxmemory",
                        "type": "string",
                        "default": "1gb",
                        "description": "最大内存限制"
                    }
                ],
                "service_config": {
                    "start_cmd": "{{.bin}}/redis-server {{.conf}}/redis.conf",
                    "stop_cmd": "{{.bin}}/redis-cli -a {{.params.password}} shutdown",
                    "systemd_template": "[Unit]\nDescription=Redis Server\nAfter=network.target\n\n[Service]\nExecStart={{.start_cmd}}\nRestart=always\n\n[Install]\nWantedBy=multi-user.target"
                },
                "config_templates": {
                    "redis.conf": "maxmemory {{.params.maxmemory}}\nmaxmemory-policy allkeys-lru",
                    "sentinel.conf": "sentinel monitor mymaster 127.0.0.1 {{.params.port}} 2"
                }
            },
            "versions": [
                {
                    "version": "7.0.12",
                    "download_url": "http://download.redis.io/releases/redis-7.0.12.tar.gz",
                    "checksum": "sha256:9dd83d5b46..."
                }
            ]
        },
        {
            "name": "nginx",
            "description": "Nginx Web服务器",
            "install_config": {
                "base_path": "{{.root}}/{{.name}}/v{{.version}}",
                "config_params": [
                    {
                        "name": "worker_processes",
                        "type": "number",
                        "default": 4,
                        "description": "工作进程数"
                    },
                    {
                        "name": "http_port",
                        "type": "number",
                        "default": 80,
                        "description": "HTTP监听端口"
                    },
                    {
                        "name": "ssl_enabled",
                        "type": "boolean",
                        "default": false,
                        "description": "启用HTTPS"
                    }
                ],
                "service_config": {
                    "start_cmd": "{{.bin}}/nginx -c {{.conf}}/nginx.conf",
                    "stop_cmd": "{{.bin}}/nginx -s stop",
                    "reload_cmd": "{{.bin}}/nginx -s reload",
                    "systemd_template": "[Unit]\nDescription=NGINX Server\nAfter=network.target\n\n[Service]\nType=forking\nExecStart={{.start_cmd}}\nExecReload={{.reload_cmd}}\nExecStop={{.stop_cmd}}\nRestart=always\n\n[Install]\nWantedBy=multi-user.target"
                },
                "config_templates": {
                    "nginx.conf": "{{template \"main.conf\" .}}",
                    "conf.d/default.conf": "server {\n listen {{.params.http_port}}{{if .params.ssl_enabled}} ssl{{end}};\n{{if .params.ssl_enabled}} ssl_certificate {{.conf}}/ssl/server.crt;\n ssl_certificate_key {{.conf}}/ssl/server.key;{{end}}\n}",
                    "ssl/server.crt": "{{.self_signed_cert}}",
                    "ssl/server.key": "{{.private_key}}"
                }
            },
            "versions": [
                {
                    "version": "1.25.3",
                    "download_url": "https://nginx.org/download/nginx-1.25.3.tar.gz",
                    "checksum": "sha256:08d..."
                }
            ]
        },
        {
            "name": "php",
            "description": "PHP脚本语言",
            "install_config": {
                "base_path": "{{.root}}/{{.name}}/v{{.version}}",
                "config_params": [
                    {
                        "name": "fpm_port",
                        "type": "number",
                        "default": 9000,
                        "description": "PHP-FPM监听端口"
                    },
                    {
                        "name": "memory_limit",
                        "type": "string",
                        "default": "256M",
                        "description": "脚本内存限制"
                    }
                ],
                "service_config": {
                    "start_cmd": "{{.bin}}/php-fpm --fpm-config {{.conf}}/php-fpm.conf",
                    "stop_cmd": "kill -INT $(cat {{.data}}/php-fpm.pid)",
                    "systemd_template": "[Unit]\nDescription=PHP FastCGI Process Manager\nAfter=network.target\n\n[Service]\nExecStart={{.start_cmd}}\nRestart=always\n\n[Install]\nWantedBy=multi-user.target"
                },
                "config_templates": {
                    "php-fpm.conf": "[global]\npid = {{.data}}/php-fpm.pid\n[www]\nlisten = 0.0.0.0:{{.params.fpm_port}}",
                    "php.ini": "memory_limit={{.params.memory_limit}}"
                }
            },
            "versions": [
                {
                    "version": "8.2.10",
                    "download_url": "https://www.php.net/distributions/php-8.2.10.tar.gz",
                    "checksum": "sha256:6..."
                }
            ]
        },
        {
            "name": "caddy",
            "description": "现代Web服务器",
            "install_config": {
                "base_path": "{{.root}}/{{.name}}/v{{.version}}",
                "config_params": [
                    {
                        "name": "admin_email",
                        "type": "string",
                        "description": "管理员邮箱(用于HTTPS证书)"
                    },
                    {
                        "name": "domain",
                        "type": "string",
                        "description": "主域名",
                        "required": true
                    }
                ],
                "service_config": {
                    "start_cmd": "{{.bin}}/caddy run --config {{.conf}}/Caddyfile",
                    "reload_cmd": "{{.bin}}/caddy reload --config {{.conf}}/Caddyfile",
                    "systemd_template": "[Unit]\nDescription=Caddy Web Server\nAfter=network.target\n\n[Service]\nExecStart={{.start_cmd}}\nRestart=always\nEnvironment=CADDY_EMAIL={{.params.admin_email}}\n\n[Install]\nWantedBy=multi-user.target"
                },
                "config_templates": {
                    "Caddyfile": "{{.params.domain}} {\n respond \"Hello from Caddy\"\n}",
                    "modules.json": "{\"modules\":[\"http.authentication\"]}"
                }
            },
            "versions": [
                {
                    "version": "2.7.5",
                    "download_url": "https://github.com/caddyserver/caddy/releases/download/v2.7.5/caddy_2.7.5_linux_amd64.tar.gz",
                    "checksum": "sha256:1e..."
                }
            ]
        }
    ]
}